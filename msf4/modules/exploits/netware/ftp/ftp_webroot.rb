require 'msf/core'

class Metasploit3 < Msf::Exploit::Remote
  Rank = ExcellentRanking

  def initialize(info = {})
    super(update_info(info,
                      'Name'        => 'FTP Webroot Payload',
                      'Version'     => '$Revision: 1 $',
                      'Description' => 'Upload and execute a msf payload to a ftp server. This ftp server should have a webroot as one of its directories.',
                      'Author'      => 'James Hovious',
                      'License'     => MSF_LICENSE,
                      'Platform' => ['win'],
                      'Targets' =>
                          [
                              ['Universal', {}]
                          ],
                      'DisclosureDate' => 'Jan 01 2000',
                      'DefaultTarget' => 0))

    register_options(
        [
          OptString.new('DATA', [true, 'The output data', 'Hello, world!']),
          OptString.new('WEBDIRECTORY', [true, 'The output data', 'Hello, world!']),
          OptString.new('FTPDIRECTORY', [true, 'The output data', 'Hello, world!']),
          OptString.new('WEBPORT', [true, 'The output data', 'Hello, world!']),
          Opt::Proxies,
          Opt::RPORT(21),
        ], self.class)

  end

  def exploit

    data = datastore['DATA']

    # for each ftp credential in the database
      # see if a web port is open
      # yes
        # attempt to log into the database
          #upload a custom file to the ftp root

      # no
        # bail out



    # echo the data
    print_good(data)

  end

end
